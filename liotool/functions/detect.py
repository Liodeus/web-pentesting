from functions.misc import *
from functions.config import *


def detect_techno(url, path):
	start_print("TECHNOLOGIE")
	os.system(f"whatweb {url} | tee {path}{FOLDER_TECHNOLOGIE}whatweb.out")
	os.system(f"webanalyze -host {url} -silent -apps {WEB_ANALYZE_TECHNO_PATH} | tee {path}{FOLDER_TECHNOLOGIE}webanalyze.out")
	end_print("TECHNOLOGIE")


def detect_waf(url, path):
	start_print("WAF")
	os.system(f"wafw00f -a -v {url} | tee {path}{FOLDER_TECHNOLOGIE}wafw00f.out")
	end_print("WAF")


def port_scan_tcp(domain, path):
	start_print("PORT SCAN TCP")
	os.system(f"rustscan -a {domain} --ulimit 5000 -n -t 4000 -- -A -sC -sV -oN {path}{FOLDER_TECHNOLOGIE}rustcan.out")
	end_print("PORT SCAN TCP") 


def make_screenshot(url, path):
	start_print("SCREENSHOT")
	os.system(f"gowitness single {url} --timeout=25 --destination='{path}{FOLDER_TECHNOLOGIE}'")
	end_print("SCREENSHOT") 